jenkins:
  build: docker/jenkins
  links:
  - artifactory
  - sonar
  - sonarmysql
  - worblehatweb
  - worblehatdb
  environment:
  - JENKINS_URL=http://jenkins:8080
  - ARTIFACTORY_URL=http://artifactory:8080/artifactory
  - SITE_DEPLOY_PATH=/home/jenkins/site-deploy/
  - WORBLEHAT_DB_HOST=worblehatdb
  - WORBLEHAT_TOMCAT_URL=http://worblehatweb:8080
  - SONAR_URL=http://sonar:9000/sonar
  - SONAR_DB_HOST=sonarmysql
  volumes:
  - site-deploy:/home/jenkins/site-deploy/
artifactory:
  image: mattgruter/artifactory:3.4.2
sonarmysql:
  image: tpires/sonar-mysql
  expose:
  - 3306
sonar:
  build: docker/sonar
  links:
  - sonarmysql:db
worblehatdb:
  image: mysql:5.6.22
  environment:
  - MYSQL_ROOT_PASSWORD=root
  - MYSQL_USER=worblehat
  - MYSQL_PASSWORD=worblehat
  - MYSQL_DATABASE=worblehat
worblehatweb:
  build: docker/tomcat
  links:
  - worblehatdb
nginx:
  build: docker/nginx
  ports:
  - "80:80"
  links:
  - jenkins
  - artifactory
  - sonar
  - worblehatweb
  volumes:
  - site-deploy/site:/usr/share/nginx/html/worblehat-site
